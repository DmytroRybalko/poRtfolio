---
title: "DAT205x: Introduction to Data Analysis using R. Lab3a"
output: html_notebook
---
# Scenario

Now that you have prepared the data in an Excel table, you can start to create pivot tables to aggregate the data and create some reports.

From your conversation with Lucy, you know that she is interested in looking into the yearly sales data broken down by countries, product categories, and age groups.

```{r setup, include = FALSE}
knitr::opts_chunk$set(root.dir = getwd())
```
Load libraries
```{r}
library(tidyverse)
library(knitr)
```
Load data for Lab3a from here: week2/data4week3.rds
```{r my_data, cache = TRUE, cache.extra = file.info("./week2/data4week3.rds")}
my_data <- readRDS("./week2/data4week3.rds")
```

#### **Question 1:** Which year did the company start selling Touring Bikes?

```{r}
my_data %>%
    arrange(Date) %>%
    filter(`Sub Category` == 'Touring Bikes') %>%
    summarise(`Which Year` = first(Year)) %>%
    kable(align = 'l')
```

---

#### **Question 2:** Rank the States for Germany, from the highest to lowest revenue

```{r}
my_data %>%
    filter(Country == 'Germany') %>%
    group_by(State) %>%
    summarise(Total = sum(Revenue)) %>%
    arrange(desc(Total)) %>%
    mutate(Rank = min_rank(desc(Total))) %>%
    kable(align = 'lcr')
```

---

#### **Question 3:** Rank the States for Germany, from the highest to lowest revenue for year 2013

```{r}
my_data %>%
    filter(Country == 'Germany', Year == 2013) %>%
    group_by(State) %>%
    summarise(Total = sum(Revenue)) %>%
    arrange(desc(Total)) %>%
    mutate(Rank = min_rank(desc(Total))) %>%
    kable(align = 'lcr')
```

---

#### **Question 4:** Which frame size sold the most?

```{r}
my_data %>%
    filter(`Product Category` == 'Bikes') %>%
    group_by(`Frame Size`) %>%
    summarise(Total = sum(Revenue)) %>%
    arrange(desc(Total)) %>%
    mutate(rank = min_rank(desc(Total))) %>%
    kable(align = 'lcr')
```

---

#### **Question 5:** Which Age Group has the lowest revenue?

```{r}
my_data %>%
    group_by(`Age Group`) %>%
    summarise(Total = sum(Revenue)) %>%
    arrange(Total) %>%
    kable(align = 'lr')
```